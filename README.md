# qilin-strm

<div align="center">

![Qilin STRM Logo](public/logo.png)

**高效、智能的 openlist STRM 文件生成工具**

[![Go Version](https://img.shields.io/badge/Go-1.24+-00ADD8?style=flat&logo=go)](https://golang.org/)
[![Vue Version](https://img.shields.io/badge/Vue-3.0+-4FC08D?style=flat&logo=vue.js)](https://vuejs.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Docker](https://img.shields.io/badge/Docker-Ready-2496ED?style=flat&logo=docker)](https://www.docker.com/)

[English](README_EN.md) | 简体中文

</div>

---

## 📖 项目简介

Qilin STRM 是一个专为 OpenList STRM 驱动设计的高效 WebDAV 文件管理工具。通过模拟用户访问网盘文件夹，快速生成 STRM 文件，完美支持 OpenList 原生驱动，确保生成速度和文件数量的准确性。

### ✨ 核心特性

- 🚀 **快速生成** - 模拟真实用户访问，快速生成 STRM 文件
- 🎯 **原生驱动** - 完美支持 OpenList STRM 驱动，无兼容性问题
- 🔄 **强制刷新** - 支持 OpenList 强制刷新功能，确保文件列表最新
- ⚡ **增量扫描** - 智能检测文件夹修改时间，避免重复扫描
- 📅 **定时任务** - 灵活的 Cron 表达式，自动化扫描任务
- 🔐 **安全认证** - JWT 令牌认证，保护数据安全
- 📊 **实时监控** - 任务执行状态和日志实时查看
- 🐳 **Docker 支持** - 多架构 Docker 镜像，一键部署
- 🎨 **现代界面** - Vue 3 + Vite 构建的现代化 Web 界面

---

## 🎯 主要功能

### 1. WebDAV 配置管理
- 支持多个 WebDAV 服务器配置
- 配置加密存储，保护敏感信息
- 一键测试连接，快速验证配置

### 2. 智能文件扫描
- **增量扫描**：基于文件夹修改时间，只扫描变更的文件夹
- **全量扫描**：支持强制刷新，获取最新的文件列表
- **子文件夹检测**：智能检测一级子文件夹的修改时间
- **扫描优化**：避免过度扫描，节省系统资源

### 3. STRM 文件生成
- 快速生成标准的 STRM 文件
- 支持批量生成，提高效率
- 完美兼容 OpenList STRM 驱动
- 生成速度和文件数量准确可靠

### 4. 定时任务管理
- 灵活的 Cron 表达式配置
- 任务启用/禁用控制
- 任务执行历史记录
- 实时查看任务执行状态和日志


### 5. 文件管理
- WebDAV 文件浏览器
- 文件夹导航
- 文件信息查看
- 手动触发文件夹扫描

---

##  安装部署

### 方式一：Docker 部署（推荐）

#### 使用 Docker Compose

现阶段为内测版，进群获取docker compse文件
- 麒麟软件交流二群(qq):698788293

#### 使用 Docker 命令


```
 
```


## 🚀 快速开始

### 1. 访问 Web 界面

启动程序后，在浏览器中访问：
```
http://localhost:5266
```

### 2. 注册用户

首次使用需要注册用户：
- 填写用户名和密码
- 密码至少 6 位字符
- 点击"注册"按钮

### 3. 配置 WebDAV 服务器

在"设置"页面添加 WebDAV 配置：
- **配置名称**：给配置起个名字
- **服务器地址**：WebDAV 服务器 URL
- **用户名**：WebDAV 用户名
- **密码**：WebDAV 密码
- 点击"添加配置"保存

### 4. 创建扫描任务

在"定时任务"页面创建任务：
- **任务名称**：给任务起个名字
- **WebDAV 配置**：选择之前创建的配置
- **扫描路径**：要扫描的文件夹路径
- **Cron 表达式**：设置定时执行时间
- **启用增量扫描**：勾选"检查修改时间"
- **启用强制刷新**：勾选"启用强制刷新"

### 5. 执行任务

- **手动执行**：点击任务列表中的"立即执行"按钮
- **定时执行**：等待 Cron 表达式触发
- **查看日志**：点击"日志"按钮查看执行日志

---

## 📝 配置说明

### Cron 表达式

Cron 表达式格式：`秒 分 时 日 月 周`

| 字段 | 取值范围 | 特殊字符 |
|------|---------|---------|
| 秒 | 0-59 | `* / , -` |
| 分 | 0-59 | `* / , -` |
| 时 | 0-23 | `* / , -` |
| 日 | 1-31 | `* / , - ?` |
| 月 | 1-12 | `* / , -` |
| 周 | 0-6 | `* / , - ?` |

**示例：**
```
0 0 * * *      # 每天凌晨 0 点执行
0 */6 * * *    # 每 6 小时执行一次
0 0 * * 0      # 每周日凌晨 0 点执行
0 0 1 * *      # 每月 1 号凌晨 0 点执行
```

### 增量扫描配置

**检查修改时间**：启用后会记录文件夹的修改时间，下次扫描时只扫描有变更的文件夹。

**子文件夹检测**：会检测一级子文件夹的修改时间，实现更精细的增量扫描。

**优势**：
- 减少不必要的扫描
- 节省系统资源
- 提高扫描速度
- 降低网络请求

### 强制刷新配置

**启用强制刷新**：在扫描前强制刷新 OpenList 的缓存，确保获取最新的文件列表。

**适用场景**：
- 网盘文件刚更新
- 需要立即获取最新状态
- 怀疑缓存数据不准确

---

## 🐳 Docker 镜像

### 多架构支持

镜像支持以下架构：
- `linux/amd64` - x86_64 架构
- `linux/arm64` - ARM64 架构




## 📊 性能优化

### 增量扫描

通过检测文件夹修改时间，实现智能增量扫描：

1. **首次扫描**：全量扫描所有文件
2. **记录时间**：记录每个文件夹的修改时间
3. **后续扫描**：只扫描有变更的文件夹
4. **节省资源**：减少不必要的网络请求和 I/O 操作

### 强制刷新

支持 OpenList 强制刷新功能：

1. **扫描前刷新**：在扫描前强制刷新缓存
2. **获取最新**：确保获取最新的文件列表
3. **准确生成**：基于最新数据生成 STRM 文件

---

## 🤝 建议指南

欢迎加群报告问题或提出建议！



## ❓ 常见问题

### Q1: 如何配置多个 WebDAV 服务器？

A: 在"设置"页面可以添加多个 WebDAV 配置，每个配置独立管理。

### Q2: 增量扫描和全量扫描有什么区别？

A: 增量扫描只扫描有变更的文件夹，速度快、资源占用少；全量扫描扫描所有文件，确保数据完整。

### Q3: 如何查看任务执行日志？

A: 在"定时任务"页面，点击任务右侧的"日志"按钮即可查看执行日志。

### Q4: 支持 OpenList 的哪些功能？

A: 完美支持 OpenList STRM 驱动，包括强制刷新、文件列表获取等功能。

### Q5: 如何修改端口？

A: 编辑 `docker-compose.yml` 文件中的端口映射，或使用 `-p` 参数指定端口。

### Q6: 数据存储在哪里？

A: 数据存储在 `data/` 目录中，包括配置、任务、日志等文件。

---

## 📄 许可证

本项目采用 [MIT 许可证](LICENSE) 开源。

---

## 🙏 致谢

- [OpenList](https://github.com/openlist-org/openlist) - 优秀的媒体列表管理工具
- [Vue.js](https://vuejs.org/) - 渐进式 JavaScript 框架
- [Go](https://golang.org/) - 高性能编程语言

---

## 📮 联系方式

- 麒麟软件交流二群(qq):698788293
- B站主页: https://space.bilibili.com/351478349?spm_id_from=333.1007.0.0


---

## 🌟 Star History

[![Star History Chart](https://api.star-history.com/svg?repos=linzxcw/qilin-strm&type=Date)](https://star-history.com/linzxcw/qilin-strm&Date)

---

<div align="center">

**如果这个项目对你有帮助，请给个 ⭐️ Star 支持一下！**

Made with ❤️ by Qilin Team

</div>
